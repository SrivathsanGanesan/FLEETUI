<div class="flex h-screen">
  <app-sidenavbar class="fixed top-0 left-0 h-full"></app-sidenavbar>
  <div class="flex-grow ml-64 p-8 h-screen overflow-auto">
    <div class="mainContent flex flex-col h-full">
      <!-- Add this button somewhere in your robot page, e.g., in the header or toolbar -->

      <!-- Header section -->
      <div class="header-section mb-4">
        <h1 class="header-title">Robot Details</h1>
        <div class="subheader-container">
          <div class="subheader-text">Create and edit task reports</div>
          <img
            src="../../assets/icons/i-icon.svg"
            alt="Icon"
            class="subheader-icon"
          />
        </div>
   
        <!-- Search and Date Filters -->
        <div class="search-filter-container">
          <!-- Search Bar -->
          <div class="search-box">
            <input type="text" placeholder="Search For Something..." />
            <button class="search-btn">
              <img src="../../assets/icons/download-removebg-preview.png" alt="Search" />
            </button>
          </div>
        </div>
   
        <!-- Action Buttons -->
        <div class="action-buttons">
          <button (click)="togglePopup()" class="add-robots-button">+ Add Robots</button>
        </div>
   
        <!-- Card Container -->
        <!-- <div class="card" *ngFor="let robot of robots" (click)="openRobotDetail(robot)"> -->
          <div class="card-container-wrapper mt-4">
            <div class="card-container">
              <div *ngFor="let robot of robots; let i = index; trackBy: trackByIndex"
                  [ngClass]="{ 'highlighted-card': i === centerIndex, 'blurred-card': i !== centerIndex }"
                  class="card">
                
                <div class="top-section">
                  <div class="icons">
                    <div class="menu-icon" (click)="toggleMenu(i)">
                      &#x22EE; <!-- HTML code for vertical ellipsis -->
                    </div>
                    <div class="popup-menu" [class.show]="menuOpenIndex === i">
                      <ul>
                        <li (click)="editRobot(i)" style="color: white;">Edit</li>
                        <li (click)="deleteRobot(i)" style="color: white;">Delete</li>
                      </ul>
                    </div>
                  </div>
                  <img [src]="robot.imageUrl" alt="{{ robot.name }}" class="robot-image">
                </div>
          
                <div class="bottom-section">
                  <h2 class="card-header title">{{ robot.name }}</h2>                
                  <div class="card-id-status">
                    <p>ID: {{ robot.id }}</p> <!-- Display ID -->
                    <p>S.no: {{ robot.serialNumber }}</p> <!-- Display Serial Number -->
                    <p>Status: <span class="robot-status">{{ robot.status }}</span></p> <!-- Display Status -->
                  </div>
                  
                  <!-- Add a dedicated button or area to trigger the popup -->
                  <div class="details-button-wrapper">
                    <button class="details-button" (click)="openRobotDetail(robot)">
                      View Details
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>

      <!-- Add Robot Popup -->
      <div *ngIf="showPopup" class="popup-overlay" (click)="togglePopup()">
        <div class="popup" (click)="$event.stopPropagation()">
          <h2>Add New Robot</h2>
          <form (ngSubmit)="addRobot()">
            <label for="name">Name:</label>
            <input id="name" [(ngModel)]="newRobot.name" name="name" required />

            <label for="imageUrl">Image URL:</label>
            <input
              id="imageUrl"
              [(ngModel)]="newRobot.imageUrl"
              name="imageUrl"
              required
            />

            <label for="capacity">Capacity:</label>
            <input
              id="capacity"
              [(ngModel)]="newRobot.capacity"
              name="capacity"
              required
            />

            <label for="speed">Speed:</label>
            <input
              id="speed"
              [(ngModel)]="newRobot.speed"
              name="speed"
              required
            />

            <label for="accuracy">Accuracy:</label>
            <input
              id="accuracy"
              [(ngModel)]="newRobot.accuracy"
              name="accuracy"
              required
            />

            <div class="flex">
              <button type="submit">Add Robot</button>
              <button type="button" (click)="togglePopup()">Cancel</button>
            </div>
          </form>
        </div>
      </div>

      <!-- Edit Robot Popup -->
      <div *ngIf="isEditPopupOpen" class="popup-overlay">
        <div class="popup">
          <h2>Edit Robot</h2>
          <form (ngSubmit)="saveRobot()">
            <div class="mb-4">
              <label for="name">Name</label>
              <input
                id="name"
                [(ngModel)]="editRobotData.name"
                name="name"
                required
              />
            </div>
            <div class="mb-4">
              <label for="imageUrl">Image URL</label>
              <input
                id="imageUrl"
                [(ngModel)]="editRobotData.imageUrl"
                name="imageUrl"
                required
              />
            </div>
            <div class="mb-4">
              <label for="capacity">Capacity</label>
              <input
                id="capacity"
                [(ngModel)]="editRobotData.capacity"
                name="capacity"
                required
              />
            </div>
            <div class="mb-4">
              <label for="speed">Speed</label>
              <input
                id="speed"
                [(ngModel)]="editRobotData.speed"
                name="speed"
                required
              />
            </div>
            <div class="mb-4">
              <label for="accuracy">Accuracy</label>
              <input
                id="accuracy"
                [(ngModel)]="editRobotData.accuracy"
                name="accuracy"
                required
              />
            </div>
            <div class="flex">
              <button type="submit">Save</button>
              <button type="button" (click)="closeEditPopup()">Cancel</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
